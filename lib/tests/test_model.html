<?xml version="1.0" encoding="UTF-8"?>
<html>
<head>
<title>Warsztat Game: Demo</title>
<script type="text/javascript" src="../dojo.js">
    //
</script>
<script type="text/javascript" src="../vmath.js">
    //
</script>
<script type="text/javascript" src="../model.js">
    //
</script>
<link rel="stylesheet" href="../main.css" type="text/css" media="all" />
</head>
<body>
    <script>
        var system = new model.System();

        var ball = new model.Ball(system, {
            P : [ 16, 16 ],
            V : [ 10, 100 ],
            R : 10
        });

        var ball2 = new model.Ball(system, {
            P : [ 40, 30 ],
            V : [ 100, 120 ],
            R : 5
        });

        new model.Edge(system, {
            A : [ -50, -50 ],
            B : [ 50, -50 ]
        });
        new model.Edge(system, {
            A : [ 50, -50 ],
            B : [ 50, 50 ]
        });
        new model.Edge(system, {
            A : [ 50, 50 ],
            B : [ -50, 50 ]
        });
        new model.Edge(system, {
            A : [ -50, 50 ],
            B : [ -50, -50 ]
        });

        dojo.create('div', {
            style : {
                position : 'absolute',
                left : '250px',
                top : '150px',
                width : '100px',
                height : '100px',
                border : '1px solid white'
            }
        }, dojo.body(), 'last')

        var step = 120;

        var iter = 0;

        while ((step -= system.doStep(step)) > 0)
            if (iter++ > 1000)
                break;

        var res = 6000;
        for ( var i = 0; i < res; i++) {
            var position = ball.getPosition(i / 100);
            var node = dojo.create('div', {
                style : {
                    position : 'absolute',
                    left : 200 + position[0] - 10 + 100 + 'px',
                    top : 100 - position[1] - 10 + 100 + 'px',
                    width : '20px',
                    height : '20px',
                    borderRadius : '15px',
                    opacity : 0.5 + i / res,
                    background : 'rgb(' + Math.floor(250 - i / res * 250) + ', ' + Math.floor(i / res * 250) + ', 0)'
                }
            });

            setTimeout(function(node) {
                dojo.place(node, dojo.body(), 'last');
                setTimeout(function() {
                    if (node.parentNode)
                        node.parentNode.removeChild(node);
                }, 20);
            }.bind(this, node), 10 * i);

            var position = ball2.getPosition(i / 100);
            var node = dojo.create('div', {
                style : {
                    position : 'absolute',
                    left : 200 + position[0] - 5 + 100 + 'px',
                    top : 100 - position[1] - 5 + 100 + 'px',
                    width : '10px',
                    height : '10px',
                    borderRadius : '5px',
                    opacity : 0.5 + i / res,
                    background : 'rgb(0, ' + Math.floor(250 - i / res * 250) + ', ' + Math.floor(i / res * 250) + ')'
                }
            });

            setTimeout(function(node) {
                dojo.place(node, dojo.body(), 'last');
                setTimeout(function() {
                    if (node.parentNode)
                        node.parentNode.removeChild(node);
                }, 20);
            }.bind(this, node), 10 * i);

        }
    </script>
</body>
</html>